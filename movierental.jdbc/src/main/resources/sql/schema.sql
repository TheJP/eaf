DROP TABLE ROLES IF EXISTS;
DROP TABLE RENTALS IF EXISTS;
DROP TABLE MOVIES IF EXISTS;
DROP TABLE USERS IF EXISTS;
DROP TABLE PRICECATEGORIES IF EXISTS;


CREATE TABLE USERS (
	USER_ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
	USER_FIRSTNAME VARCHAR(255),
	USER_NAME VARCHAR(255),
	USER_EMAIL VARCHAR(255)
);

CREATE TABLE PRICECATEGORIES (
	PRICECATEGORY_ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
	PRICECATEGORY_TYPE VARCHAR(32)
);

CREATE TABLE MOVIES (
	MOVIE_ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
	MOVIE_RELEASEDATE DATE,
	MOVIE_TITLE VARCHAR(255),
	MOVIE_RENTED BOOLEAN,
	PRICECATEGORY_FK BIGINT
);
ALTER TABLE MOVIES ADD CONSTRAINT FK_CATEGORY 
	FOREIGN KEY (PRICECATEGORY_FK) REFERENCES PRICECATEGORIES(PRICECATEGORY_ID);


CREATE TABLE RENTALS (
	RENTAL_ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
	RENTAL_RENTALDATE DATE,
	RENTAL_RENTALDAYS INTEGER,
	USER_ID BIGINT,
	MOVIE_ID BIGINT
);
ALTER TABLE RENTALS ADD CONSTRAINT FK_USER
	FOREIGN KEY (USER_ID) REFERENCES USERS(USER_ID);
ALTER TABLE RENTALS ADD CONSTRAINT FK_MOVIE
	FOREIGN KEY (MOVIE_ID) REFERENCES MOVIES(MOVIE_ID);
